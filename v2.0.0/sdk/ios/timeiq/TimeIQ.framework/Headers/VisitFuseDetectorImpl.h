//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: //com/intel/wearable/platform/timeiq/places/modules/visitsmodule/algs/VisitFuseDetectorImpl.java
//

#ifndef _VisitFuseDetectorImpl_H_
#define _VisitFuseDetectorImpl_H_

@class FusedLocVisitDetector;
#import "NSNumber+JavaAPI.h"
#import "JBArrayList.h"
@class Similarity;
@class Visit;
@class WifiScan;
@class WifiSimilarityAlg;
@protocol ILocationData;
@protocol IVisitListener;
#import "JBArrayList.h"

#import "JB.h"
#import "IVisitDetectorImpl.h"

#define VisitFuseDetectorImpl_DISTANCE_LIMIT_FOR_COMBINING_VISITS 40
#define VisitFuseDetectorImpl_DISTANCE_LIMIT_FOR_COMBINING_VISITS_FIRST_TIME 100
#define VisitFuseDetectorImpl_MIN_TIME_FOR_VISIT 180000
#define VisitFuseDetectorImpl_SPEED_LIMIT_FOR_INVALID_SAMPLES 100
#define VisitFuseDetectorImpl_TIME_LIMIT_FOR_COMBINING_VISITS 1800000

@interface VisitFuseDetectorImpl : NSObject < IVisitDetectorImpl > {
 @public
  id<ILocationData> lastFuseLocation_;
  FusedLocVisitDetector *locVisitDet_;
  Visit *currentVisit_;
  ArrayList* listeners_;
  ArrayList* visits_;
  /**
   @brief used for simulation mode.
   The time stamp is received from the Wifi scan parameters
   */
  long64 lastTimeStamp_;
  long64 lastTimeStampRecordedForVisit_;
  int numSamplesNotSent_;
  long64 fusedLocStartOfVisit_;
  JBBoolean *inAVisit_;
  JBBoolean *visitStartHysteresisTime_;
  Visit *previousVisit_;
  WifiSimilarityAlg *scans_;
  WifiScan *lastWifiScan_;
  Similarity *lastWifiSimilarity_;
  boolean wifiSigSetup_;
  ArrayList *simWindow_;
  int simWindowSize_;
  boolean useWifi_;
  WifiSimilarityAlg *ssidScans_;
  boolean ssidSigSetup_;
  ArrayList *ssidSimWindow_;
  int ssidSimWindowSize_;
}

- (instancetype)init;

- (void)onWifiRecieveWithWifiScan:(WifiScan *)wifiScan;

- (void)RecvSSIDWifiWithWifiScan:(WifiScan *)wifiScan;

- (void)onLocationRecieveWithILocationData:(id<ILocationData>)fuseLocation;

- (void)reportVisitBeginWithVisit:(Visit *)visit;

- (void)reportVisitEndWithVisit:(Visit *)currentVisit;

- (void)registerVisitListenerWithIVisitListener:(id<IVisitListener>)listener;

- (ArrayList*)getVisitListeners;

- (void)unregisterVisitListenerWithIVisitListener:(id<IVisitListener>)listener;

- (ArrayList*)getVisits;

- (Visit *)getCurrentVisit;

- (void)rePlayVisits;

- (void)restoreModule;

- (JBBoolean *)combineWithPreviousVisitWithVisit:(Visit *)newVisit
                                               withInt:(int)distanceThreshold;

- (Visit *)getLastOpenVisit;

- (void)SampleIntervalChangedWithLong:(long64)sampleInterval;

- (JBBoolean *)CheckIfValidSampleWithILocationData:(id<ILocationData>)newSample
                                       withILocationData:(id<ILocationData>)prevSample;

- (void)InitWiFiSimWindowWithArrayList:(ArrayList *)similarityWindow;

- (double)GetSmoothedWiFiSimilarityScoreWithArrayList:(ArrayList *)similarityWindow;

- (JBBoolean *)IsWiFiAvailableWithLong:(long64)currentTime;

- (JBBoolean *)VisitAccordingToWiFiWithLong:(long64)currentTime
                                       withDouble:(double)threshold;

- (double)GetDistanceKMWithDouble:(double)fromLat
                        withDouble:(double)fromLong
                        withDouble:(double)toLat
                        withDouble:(double)toLong;

- (void)copyAllFieldsTo:(VisitFuseDetectorImpl *)other;

@end

FOUNDATION_EXPORT BOOL VisitFuseDetectorImpl_initialized;
J2OBJC_STATIC_INIT(VisitFuseDetectorImpl)

//J2OBJC_FIELD_SETTER(VisitFuseDetectorImpl, lastFuseLocation_, id<ILocationData>)
//J2OBJC_FIELD_SETTER(VisitFuseDetectorImpl, locVisitDet_, FusedLocVisitDetector *)
//J2OBJC_FIELD_SETTER(VisitFuseDetectorImpl, currentVisit_, Visit *)
//J2OBJC_FIELD_SETTER(VisitFuseDetectorImpl, listeners_, ArrayList*)
//J2OBJC_FIELD_SETTER(VisitFuseDetectorImpl, visits_, ArrayList*)
//J2OBJC_FIELD_SETTER(VisitFuseDetectorImpl, inAVisit_, JBBoolean *)
//J2OBJC_FIELD_SETTER(VisitFuseDetectorImpl, visitStartHysteresisTime_, JBBoolean *)
//J2OBJC_FIELD_SETTER(VisitFuseDetectorImpl, previousVisit_, Visit *)
//J2OBJC_FIELD_SETTER(VisitFuseDetectorImpl, scans_, WifiSimilarityAlg *)
//J2OBJC_FIELD_SETTER(VisitFuseDetectorImpl, lastWifiScan_, WifiScan *)
//J2OBJC_FIELD_SETTER(VisitFuseDetectorImpl, lastWifiSimilarity_, Similarity *)
//J2OBJC_FIELD_SETTER(VisitFuseDetectorImpl, simWindow_, ArrayList *)
//J2OBJC_FIELD_SETTER(VisitFuseDetectorImpl, ssidScans_, WifiSimilarityAlg *)
//J2OBJC_FIELD_SETTER(VisitFuseDetectorImpl, ssidSimWindow_, ArrayList *)

FOUNDATION_EXPORT NSString *VisitFuseDetectorImpl_TAG_;
J2OBJC_STATIC_FIELD_GETTER(VisitFuseDetectorImpl, TAG_, NSString *)

J2OBJC_STATIC_FIELD_GETTER(VisitFuseDetectorImpl, TIME_LIMIT_FOR_COMBINING_VISITS, int)

J2OBJC_STATIC_FIELD_GETTER(VisitFuseDetectorImpl, DISTANCE_LIMIT_FOR_COMBINING_VISITS, int)

J2OBJC_STATIC_FIELD_GETTER(VisitFuseDetectorImpl, DISTANCE_LIMIT_FOR_COMBINING_VISITS_FIRST_TIME, int)

J2OBJC_STATIC_FIELD_GETTER(VisitFuseDetectorImpl, SPEED_LIMIT_FOR_INVALID_SAMPLES, int)

J2OBJC_STATIC_FIELD_GETTER(VisitFuseDetectorImpl, MIN_TIME_FOR_VISIT, int)

typedef VisitFuseDetectorImpl ComIntelWearablePlatformTimeiqPlacesModulesVisitsmoduleAlgsVisitFuseDetectorImpl;

#endif // _VisitFuseDetectorImpl_H_
